db.tickets.insert(
    {
        "type":"email",
        "subject":"oHVsYpICol / KENYA / 1064466 / IJAZ / Beelinks",
        "nsp":"/localhost.com",
        "priority":"LOW",
        "state":"OPEN",
        "datetime":"2020-07-27T10:00:00.689Z",
        "from":"c.a.anjichi@gmail.com",
        "visitor":{
           "name":"Cornelious",
           "email":"c.a.anjichi@gmail.com",
           "phone":"254713582619"
        },
        "lasttouchedTime":"2020-07-27T10:00:00.689Z",
        "viewState":"UNREAD",
        "createdBy":"Agent",
        "agentName":"stmusarrat9159@sbtjapan.com",
        "ticketlog":[
           {
              "title":"Assigned To Group",
              "status":"Kenya Inquires",
              "updated_by":"Rule Dispatcher",
              "user_type":"Agent",
              "time_stamp":"2020-07-27T10:00:00.692Z"
           },
           {
              "title":"Dynamic field 'Inquire Source' updated to",
              "status":"LIVE CHAT",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.753Z"
           },
           {
              "title":"assigned to",
              "status":"ijaz9894@sbtjapan.com",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.756Z"
           },
           {
              "title":"Dynamic field 'Customer Tagging' updated to",
              "status":"Tagged",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.756Z"
           },
           {
              "title":"Dynamic field 'CM ID' updated to",
              "status":"1064466",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.756Z"
           },
           {
              "title":"Dynamic field 'Customer' updated to",
              "status":"Register",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.756Z"
           },
           {
              "title":"Dynamic field 'Customer Details' updated to",
              "status":"Complete",
              "updated_by":"Custom Dispatcher",
              "user_type":"Custom Dispatcher",
              "time_stamp":"2020-07-27T10:00:00.756Z"
           },
           {
              "title":"Tag Entered ",
              "status":[
                 "#TAGGED"
              ],
              "time_stamp":"2020-07-27T10:00:23.783Z",
              "updated_by":"uthayaraj3515@sbtjapan.com",
              "user_type":"Agent"
           },
           {
              "title":"Ticket Assigned by ICONN Registration to ",
              "status":"kungu@sbtjapan.com",
              "time_stamp":"2020-07-27T10:35:22.128Z",
              "updated_by":"ijaz9894@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Ticket Set As ",
              "status":"UNREAD",
              "time_stamp":"2020-07-27T10:35:22.132Z",
              "updated_by":"System",
              "user_type":"Agent"
           },
           {
              "title":"Icon Customer Registered with Customer ID: ",
              "status":1064466,
              "time_stamp":"2020-07-27T10:35:20.491Z",
              "updated_by":"ijaz9894@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Dynamic field Updated by ICONN Registration to  named: CM ID",
              "status":1064466,
              "time_stamp":"2020-07-27T10:35:20.666Z",
              "updated_by":"ijaz9894@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Ticket Set As ",
              "status":"READ",
              "time_stamp":"2020-07-27T10:35:16.686Z",
              "updated_by":"ijaz9894@sbtjapan.com",
              "user_type":"Agent"
           },
           {
              "title":"Dynamic field Updated by ICONN Registration to  named: CM ID",
              "status":1064466,
              "time_stamp":"2020-07-27T11:13:34.191Z",
              "updated_by":"yasirarshad_9515@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Icon Customer Registered with Customer ID: ",
              "status":1064466,
              "time_stamp":"2020-07-27T11:13:34.595Z",
              "updated_by":"yasirarshad_9515@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Icon Customer Registered with Customer ID: ",
              "status":1064466,
              "time_stamp":"2020-07-27T11:44:34.474Z",
              "updated_by":"yasirarshad_9515@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           },
           {
              "title":"Dynamic field Updated by ICONN Registration to  named: CM ID",
              "status":1064466,
              "time_stamp":"2020-07-27T11:44:34.986Z",
              "updated_by":"yasirarshad_9515@sbtjapan.com (by ICONN Platform) ",
              "user_type":"Agent"
           }
        ],
        "mergedTicketIds":[
     
        ],
        "viewColor":"#FF99CB",
        "group":"Kenya Inquires",
        "source":"panel",
        "slaPolicy":{
           "reminderResolution":false,
           "reminderResponse":false,
           "violationResponse":false,
           "violationResolution":false
        },
        "assignmentList":[
           {
              "assigned_to":"ijaz9894@sbtjapan.com",
              "assigned_time":"2020-07-27T10:00:00.756Z",
              "read_date":"2020-07-27T10:35:16.686Z"
           },
           {
              "assigned_to":"kungu@sbtjapan.com",
              "assigned_time":"2020-07-27T10:35:22.129Z",
              "read_date":""
           }
        ],
        "clientID":"xMDri",
        "dynamicFields":{
           "Inquire Source":"LIVE CHAT",
           "Customer Tagging":"Tagged",
           "CM ID":1064466,
           "Customer":"Register",
           "Customer Details":"Complete"
        },
        "first_assigned_time":"2020-07-27T10:00:00.756Z",
        "sbtVisitor":"c.a.anjichi@gmail.com",
        "tags":[
           "#TAGGED"
        ],
        "first_read_date":"2020-07-27T10:35:16.686Z",
        "previousAgent":"ijaz9894@sbtjapan.com",
        "assigned_to":"kungu@sbtjapan.com",
        "CustomerInfo":{
           "customerId":1064466,
           "customerName":"Cornelious Anjichi",
           "customerRank":"N",
           "customerCountry":"KENYA",
           "customerType":"Personal",
           "customerPhone":[
              "254713582619"
           ],
           "customerEmail":[
              "vero.anjichi@gmail.com"
           ],
           "salesPersonName":"IJAZ",
           "salesPersonCode":"5887",
           "salesPersonOffice":"Karachi"
        },
        "RelatedCustomerInfo":[
           {
              "customerId":123046,
              "customerName":"Cornelious Anjichi",
              "customerRank":"N",
              "customerType":"Personal",
              "customerCountry":"KENYA",
              "salesPersonName":"KUNGU",
              "salesPersonCode":"8844",
              "salesPersonOffice":"Nairobi1",
              "customerEmail":[
                 "anjichijr@yahoo.com"
              ],
              "customerPhone":[
                 "254713582619"
              ]
           }
        ],
        "reg_date":"2020-07-27T11:44:34.474Z",
        "last_read_date":"2020-07-27T10:35:16.686Z"
     }
);

{"_id":"5e0c478e5529e62888e0eb41","group_name":"group next","group_desc":"desc next","agent_list":[{"email":"anasayyubi@gmail.com","count":5,"isAdmin":false,"excluded":false},{"email":"f@f.com","count":0,"isAdmin":false,"excluded":false},{"email":"bali@local.com","count":1,"isAdmin":false,"excluded":false}],"auto_assign":{"enabled":false,"type":"roundrobin"},"nsp":"/localhost.com","generalSettings":{"assignmentLimit":2,"enabled":true,"fallbackLimitExceed":"mufahad9213@sbtjapan.com","fallbackNoShift":"mufahad9213@sbtjapan.com","unAvailibilityHours":[{"weekDay":"Mon","duration":8,"startTime":"33:00"},{"weekDay":"Tue","duration":8,"startTime":"34:0"},{"weekDay":"Wed","duration":8,"startTime":"34:60"},{"weekDay":"Thurs","duration":8,"startTime":"36:00"},{"weekDay":"Fri","duration":8,"startTime":"37:0"},{"weekDay":"Sat","duration":8,"startTime":"37:60"},{"weekDay":"Sun","duration":8,"startTime":"39:00"}],"unEntertainedTime":5}}


db.emailRecipients.find({}).forEach(x => {
	x.iconnDispatcherTicketView = false;
	db.emailRecipients.save(x);
})

ShiftTime:{
    email:"murti_52@live.com",
    ShiftStart:"15:00",
    Duration:"6"
}
unAvailibilityHours:[
    {
       "weekDay":"Mon",
       "duration":8,
       "startTime":"12:30"
    },
    {
       "weekDay":"Tue",
       "duration":7,
       "startTime":"20:00"
    },
    {
       "weekDay":"Wed",
       "duration":6,
       "startTime":"6:00"
    },
    {
       "weekDay":"Thurs",
       "duration":5,
       "startTime":"7:15"
    },
    {
       "weekDay":"Fri",
       "duration":4,
       "startTime":"2:45"
    },
    {
       "weekDay":"Sat",
       "duration":7,
       "startTime":"15:60"
    },
    {
       "weekDay":"Sun",
       "duration":6,
       "startTime":"23:00"
    }
 ],

use companiesDB
var defaultPermissions = {
    tickets: {
        enabled: true,
        canMerge: true,
        canCreate: true,
        canAddGroupAdmins: true,
        canViewLog: true,
        canGroup: true,
        allowCC: true,
        allowBCC: true,
        canView: 'all',
        canAssignAgent: true,
        canAssignGroup: true,
        canAddNote: true,
        canAddTag: true,
        canAddTask: true,
        canChangeState: true,
        canExport: true,
        canSetPriority: true,
        canSnooze: true,
        canSearchIconCustomer: true,
        canRegisterIconCustomer: true,
        canSeeRegisteredIconCustomer: true,
        canSeeRelatedCustomerInfo: true
    },
    agents: {
        enabled: true,
        canCreate: true,
        canEdit: true,
        canChat: true,
        canCall: true,
        canViewStats: true,
        canChangeOwnPassword: true,
        canChangeOthersPassword: true,
        allowedChangeConcurrentChat: true,
        chatSuperVision: true,
        chatSuperVisionIntrusion: false,
        canAddConversationTag: true,
        canEditOthers: true
    },
    chats: {
        enabled: true,
        allowEmoji: true,
        allowAttachments: true,
        allowVoicenotes: true,
        allowCalling: true,
        allowAddAsFaq: true,
        allowChatTransfer: true,
        allowTypingStatus: true,
        canView: 'all',
        canChat: true,
        canRegisterIconCustomer: true,
        canSearchIconCustomer: true,
        canSeeRegisteredIconCustomer: true,
        canSeeRelatedCustomerInfo: true
    },
    dashboard: {
        enabled: true
    },
    visitors: {
        enabled: true
    },
    analytics: {
        enabled: true,
        canView: 'all',
        visitors: true,
        chats: true,
        agents: true,
        tickets: true
    },
    crm: {
        enabled: true
    },
    chatbot: {
        enabled: true
    },
    installation: {
        enabled: true
    },
    settings: {
        enabled: true,
        automatedResponses: {
            enabled: true
        },
        rolesAndPermissions: {
            enabled: true,
            canView: [],
            canAddRole: true,
            canModifyOwn: false,
            canModifyOther: true,
            canDeleteRole: true
        },
        formDesigner: {
            enabled: true
        },
        ticketManagement: {
            enabled: true,
            groupManagement: {
                enabled: true,
                canCreate: true,
                canDelete: true,
                canAddAgents: true,
                canRemoveAgents: true,
                canView: 'all',
                groupViewList: [],
            },
            teamManagement: {
                enabled: true,
                canCreate: true,
                canDelete: true,
                canAddAgents: true,
                canRemoveAgents: true,
                canView: 'all',
                teamViewList: [],
            },
            rulesetSettings: {
                enabled: true,
                canCreate: true,
                canModify: true,
                canToggle: true,
                canDelete: true
            },
            rulesetScheduler: {
                enabled: true
            },
            generalNotifications: {
                enabled: true
            },
            ticketTemplateDesigner: {
                enabled: true
            },
            permissionSettings: {
                enabled: true
            },
            formDesigner: {
                enabled: true
            },
            emailTemplateDesigner: {
                enabled: true
            },
            incomingEmails: {
                enabled: true
            },
            SLAPolicies: {
                enabled: true
            },
            ticketScenarioAutomation: {
                enabled: true
            },
            customFields: {
                enabled: true,
                canCreate: true,
                canModify: true,
                canDelete: true
            },
            customSatisfactionSurvey: {
                enabled: true
            }
        },
        chatTimeouts: {
            enabled: true
        },
        callSettings: {
            enabled: true
        },
        contactSettings: {
            enabled: true
        },
        chatWindowSettings: {
            enabled: true
        },
        chatAssistant: {
            enabled: true
        },
        webhooks: {
            enabled: true
        },
        integerations: {
            enabled: true
        },
        knowledgeBase: {
            enabled: true
        },
        widgetMarketing: {
            enabled: true
        }
    },
    createdBy: 'murtaza'
}

db.defaultPermissions.update({ createdBy: 'murtaza' }, defaultPermissions, { upsert: true })

db.companies.find({}).forEach(function (x) {
    Object.keys(x.settings.permissions).map(key => {
        x.settings.permissions[key].chats.canSearchIconCustomer = true;
    });
    db.companies.save(x);
});

// x.settings.permissions[key].tickets.canSearchIconCustomer = true;
// x.settings.permissions[key].tickets.canRegisterIconCustomer = true;
// x.settings.permissions[key].tickets.canSeeRegisteredIconCustomer = true;
// x.settings.permissions[key].tickets.canSeeRelatedCustomerInfo = true;
// x.settings.permissions[key].chats.canRegisterIconCustomer = true;
// x.settings.permissions[key].chats.canSeeRegisteredIconCustomer = true;

use agentsDB
db.agents.find({}).forEach(x => {
    x.settings.windowNotifications = { newTicket: true, ticketMessage: true, ticketAssigned: true, ticketUpdated: true, agentConversation: true, agentMessage: true, visitorConversation: true, visitorMessage: true };
    x.settings.emailNotifications = { newTickCreate: true, assignToAgent: true, unattendTickGroup: true, repliesToTicket: true, noteAddTick: true, agentInviteEmail: true };
    db.agents.save(x);
});

//Agent creation
{
    first_name: 'Azka',
        last_name: 'Aslam',
            phone_no: '090078601',
                nickname: 'azka',
                    username: 'azka_aslam',
                        password: '12345678',
                            group: ['DF'],
                                email: 'azka@sbtjapan.com',
                                    role: 'agent',
                                        gender: 'Female',
                                            nsp: '/beelinks.solutions',
                                                created_date: '2020-01-21T15:31:12.005Z',
                                                    created_by: 'dev.bizzchats@gmail.com',
                                                        editsettings: {
        editprofilepic: true,
            editname: true,
                editnickname: true,
                    editpassword: true,
     },
    communicationAccess: {
        enablechat: true,
            voicecall: true,
                videocall: true,
    },
    settings: {
        simchats: true,
            emailNotifications : { newTickCreate: true, assignToAgent: true, unattendTickGroup: true, repliesToTicket: true, noteAddTick: true, agentInviteEmail: true },
        windowNotifications: { newTicket: true, ticketMessage: true, ticketAssigned: true, ticketUpdated: true, agentConversation: true }

    }
}

